<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#6200ee"><meta name="author" content="Explorer"><meta name="copyright" content="Explorer"><meta name="generator" content="Hexo 6.0.0"><meta name="theme" content="hexo-theme-yun"><title>Pythonå¤šä»»åŠ¡-è¿›ç¨‹ | explorerã®åšå®¢</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/star-markdown-css@0.2.4/dist/yun/yun-markdown.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prism-theme-vars/base.css"><script src="//at.alicdn.com/t/font_1140697_dxory92pb0h.js" async></script><script src="https://cdn.jsdelivr.net/npm/@unocss/runtime/mini.global.js"></script><script src="https://cdn.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".markdown-body img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link class="aplayer-style-marker" rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/aplayer@latest/dist/APlayer.min.css"><script class="aplayer-script-marker" src="https://cdn.jsdelivr.net/npm/aplayer@latest/dist/APlayer.min.js" defer></script><script class="meting-script-marker" src="https://cdn.jsdelivr.net/npm/meting@1/dist/Meting.min.js" defer></script><link rel="icon" type="image/png" href="/./favicon.ico"><link rel="mask-icon" href="/./favicon.ico" color="#6200ee"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><script id="yun-config">
    window.Yun = {}
    window.CONFIG = {"hostname":"ccsu.top","root":"/","title":["Wu","Shuai","ã®","Blog"],"version":"1.8.8","mode":"auto","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}.","hits":"${hits} results found","hits_time":"${hits} results found in ${time} ms"},"anonymous_image":"https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/avatar/none.jpg","say":{"api":"https://v1.hitokoto.cn","hitokoto":true},"local_search":{"path":"/search.xml"},"fireworks":{"colors":["102, 167, 221","62, 131, 225","33, 78, 194"]},"waline":{"config":{"enable":true,"serverURL":"https://blog-api-seven-vert.vercel.app/","comment":false,"visitor":false,"emoji":["https://cdn.jsdelivr.net/gh/walinejs/emojis@latest/bilibili/","https://cdn.jsdelivr.net/gh/walinejs/emojis@latest/weibo/","https://cdn.jsdelivr.net/gh/walinejs/emojis@latest/qq/"],"locale":{"placeholder":"2506812280@qq.com"},"requiredMeta":["nick"],"el":"#waline","lang":"en","path":"/posts/b23c6bbe/"},"cdn":"https://cdn.jsdelivr.net/npm/@waline/client/dist/Waline.min.js","dark":"html.dark"},"vendors":{"darken":"https://cdn.jsdelivr.net/npm/darken@1.5.0"}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/hexo-theme-yun.js" type="module"></script><link rel="alternate" href="/atom.xml" title="explorerã®åšå®¢" type="application/atom+xml"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin><script async src="https://www.googletagmanager.com/gtag/js?id=G-BMBD00SVV4"></script><script>if (CONFIG.hostname === location.hostname) {
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-BMBD00SVV4');
}</script><script>(function(){
  var bp = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  if (curProtocol === 'https') {
    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else {
    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(bp, s);
})();</script><!-- Google Tag Manager --><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-M9KWR9L');</script><!-- End Google Tag Manager --><meta name="description" content="è¿›ç¨‹ä»¥åŠçŠ¶æ€1. è¿›ç¨‹ç¨‹åºï¼šä¾‹å¦‚xxx.pyè¿™æ˜¯ç¨‹åºï¼Œæ˜¯ä¸€ä¸ªé™æ€çš„ è¿›ç¨‹ï¼šä¸€ä¸ªç¨‹åºè¿è¡Œèµ·æ¥åï¼Œä»£ç +ç”¨åˆ°çš„èµ„æº ç§°ä¹‹ä¸ºè¿›ç¨‹ï¼Œå®ƒæ˜¯æ“ä½œç³»ç»Ÿåˆ†é…èµ„æºçš„åŸºæœ¬å•å…ƒã€‚ ä¸ä»…å¯ä»¥é€šè¿‡çº¿ç¨‹å®Œæˆå¤šä»»åŠ¡ï¼Œè¿›ç¨‹ä¹Ÿæ˜¯å¯ä»¥çš„ 2. è¿›ç¨‹çš„çŠ¶æ€å·¥ä½œä¸­ï¼Œä»»åŠ¡æ•°å¾€å¾€å¤§äºcpuçš„æ ¸æ•°ï¼Œå³ä¸€å®šæœ‰ä¸€äº›ä»»åŠ¡æ­£åœ¨æ‰§è¡Œï¼Œè€Œå¦å¤–ä¸€äº›ä»»åŠ¡åœ¨ç­‰å¾…cpuè¿›è¡Œæ‰§è¡Œï¼Œå› æ­¤å¯¼è‡´äº†æœ‰äº†ä¸åŒçš„çŠ¶æ€   å°±ç»ªæ€ï¼šè¿è¡Œçš„æ¡ä»¶éƒ½å·²ç»æ…¢å»ï¼Œæ­£åœ¨ç­‰åœ¨cpuæ‰§è¡Œ æ‰§è¡Œ">
<meta property="og:type" content="article">
<meta property="og:title" content="Pythonå¤šä»»åŠ¡-è¿›ç¨‹">
<meta property="og:url" content="http://ccsu.top/posts/b23c6bbe/index.html">
<meta property="og:site_name" content="explorerã®åšå®¢">
<meta property="og:description" content="è¿›ç¨‹ä»¥åŠçŠ¶æ€1. è¿›ç¨‹ç¨‹åºï¼šä¾‹å¦‚xxx.pyè¿™æ˜¯ç¨‹åºï¼Œæ˜¯ä¸€ä¸ªé™æ€çš„ è¿›ç¨‹ï¼šä¸€ä¸ªç¨‹åºè¿è¡Œèµ·æ¥åï¼Œä»£ç +ç”¨åˆ°çš„èµ„æº ç§°ä¹‹ä¸ºè¿›ç¨‹ï¼Œå®ƒæ˜¯æ“ä½œç³»ç»Ÿåˆ†é…èµ„æºçš„åŸºæœ¬å•å…ƒã€‚ ä¸ä»…å¯ä»¥é€šè¿‡çº¿ç¨‹å®Œæˆå¤šä»»åŠ¡ï¼Œè¿›ç¨‹ä¹Ÿæ˜¯å¯ä»¥çš„ 2. è¿›ç¨‹çš„çŠ¶æ€å·¥ä½œä¸­ï¼Œä»»åŠ¡æ•°å¾€å¾€å¤§äºcpuçš„æ ¸æ•°ï¼Œå³ä¸€å®šæœ‰ä¸€äº›ä»»åŠ¡æ­£åœ¨æ‰§è¡Œï¼Œè€Œå¦å¤–ä¸€äº›ä»»åŠ¡åœ¨ç­‰å¾…cpuè¿›è¡Œæ‰§è¡Œï¼Œå› æ­¤å¯¼è‡´äº†æœ‰äº†ä¸åŒçš„çŠ¶æ€   å°±ç»ªæ€ï¼šè¿è¡Œçš„æ¡ä»¶éƒ½å·²ç»æ…¢å»ï¼Œæ­£åœ¨ç­‰åœ¨cpuæ‰§è¡Œ æ‰§è¡Œ">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://raw.githubusercontent.com/wushuai2000/PicGo/main/img/20220319220239.png">
<meta property="og:image" content="https://raw.githubusercontent.com/wushuai2000/PicGo/main/img/20220319221932.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/wushuai2000/PicGo/main/img/20220319221950.png">
<meta property="og:image" content="https://raw.githubusercontent.com/wushuai2000/PicGo/main/img/20220319222001.gif">
<meta property="og:image" content="https://raw.githubusercontent.com/wushuai2000/PicGo/main/img/20220319222345.gif">
<meta property="article:published_time" content="2022-03-19T16:53:00.000Z">
<meta property="article:modified_time" content="2022-03-19T16:53:47.616Z">
<meta property="article:author" content="Explorer">
<meta property="article:tag" content="è¿›ç¨‹">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/wushuai2000/PicGo/main/img/20220319220239.png"><script>(function() {
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
  const setting = localStorage.getItem('darken-mode') || 'auto'
  if (setting === 'dark' || (prefersDark && setting !== 'light'))
    document.documentElement.classList.toggle('dark', true)
})()</script></head><body><script defer src="https://cdn.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js" type="module"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js" type="module"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="Table of Contents"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-list-ordered"></use></svg></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="Overview"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-passport-line"></use></svg></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="Explorer"><img width="96" loading="lazy" src="/images/avatar.jpg" alt="Explorer"><span class="site-author-status" title="åŠªåŠ›å­¦ä¹ ">ğŸ˜„</span></a><div class="site-author-name"><a href="/about/">Explorer</a></div><span class="site-name">explorerã®åšå®¢</span><sub class="site-subtitle"></sub><div class="site-desciption">å‰è·¯æ¼«æ¼«ï¼Œå½“å…‹å·±ï¼Œå½“æ…ç‹¬!</div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="Home"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-home-4-line"></use></svg></span></a><div class="site-state-item"><a href="/archives/" title="Archives"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-archive-line"></use></svg></span><span class="site-state-item-count">65</span></a></div><div class="site-state-item"><a href="/categories/" title="Categories"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-2-line"></use></svg></span><span class="site-state-item-count">16</span></a></div><div class="site-state-item"><a href="/tags/" title="Tags"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="site-state-item-count">63</span></a></div><a class="site-state-item hty-icon-button" href="/about/" title="ç•™è¨€æ¿"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-clipboard-line"></use></svg></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="/atom.xml" title="RSS" target="_blank" style="color:orange"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-rss-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/wushuai2000" title="GitHub" target="_blank" style="color:#6e5494"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-github-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://music.163.com/#/user/home?id=549838440" title="ç½‘æ˜“äº‘éŸ³ä¹" target="_blank" style="color:#C20C0C"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-netease-cloud-music-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://www.zhihu.com/people/huan-ji-91-3/" title="çŸ¥ä¹" target="_blank" style="color:#0084FF"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-zhihu-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://space.bilibili.com/345844264" title="å“”å“©å“”å“©" target="_blank" style="color:#FF8EB3"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-bilibili-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:2506812280@qq.com" title="E-Mail" target="_blank" style="color:#8E71C1"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-mail-line"></use></svg></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="æˆ‘çš„å°ä¼™ä¼´ä»¬" style="color:dodgerblue"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-genderless-line"></use></svg></a><a class="links-item hty-icon-button" href="/albums/" title="ç›¸å†Œ" style="color:dodgerblue"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-gallery-line"></use></svg></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-contrast-2-line"></use></svg></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B%E4%BB%A5%E5%8F%8A%E7%8A%B6%E6%80%81"><span class="toc-number">1.</span> <span class="toc-text">è¿›ç¨‹ä»¥åŠçŠ¶æ€</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%BF%9B%E7%A8%8B"><span class="toc-number">1.0.1.</span> <span class="toc-text">1. è¿›ç¨‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E8%BF%9B%E7%A8%8B%E7%9A%84%E7%8A%B6%E6%80%81"><span class="toc-number">1.0.2.</span> <span class="toc-text">2. è¿›ç¨‹çš„çŠ¶æ€</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B%E7%9A%84%E5%88%9B%E5%BB%BA-multiprocessing"><span class="toc-number">2.</span> <span class="toc-text">è¿›ç¨‹çš„åˆ›å»º-multiprocessing</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2%E4%B8%AAwhile%E5%BE%AA%E7%8E%AF%E4%B8%80%E8%B5%B7%E6%89%A7%E8%A1%8C"><span class="toc-number">2.0.1.</span> <span class="toc-text">1. 2ä¸ªwhileå¾ªç¯ä¸€èµ·æ‰§è¡Œ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%B4%E6%98%8E"><span class="toc-number">2.0.1.1.</span> <span class="toc-text">è¯´æ˜</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E8%BF%9B%E7%A8%8Bpid"><span class="toc-number">2.0.2.</span> <span class="toc-text">2. è¿›ç¨‹pid</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Process%E8%AF%AD%E6%B3%95%E7%BB%93%E6%9E%84%E5%A6%82%E4%B8%8B%EF%BC%9A"><span class="toc-number">2.0.3.</span> <span class="toc-text">3. Processè¯­æ³•ç»“æ„å¦‚ä¸‹ï¼š</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E7%BB%99%E5%AD%90%E8%BF%9B%E7%A8%8B%E6%8C%87%E5%AE%9A%E7%9A%84%E5%87%BD%E6%95%B0%E4%BC%A0%E9%80%92%E5%8F%82%E6%95%B0"><span class="toc-number">2.0.4.</span> <span class="toc-text">4. ç»™å­è¿›ç¨‹æŒ‡å®šçš„å‡½æ•°ä¼ é€’å‚æ•°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E8%BF%9B%E7%A8%8B%E9%97%B4%E4%B8%8D%E5%90%8C%E4%BA%AB%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F"><span class="toc-number">2.0.5.</span> <span class="toc-text">5. è¿›ç¨‹é—´ä¸åŒäº«å…¨å±€å˜é‡</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9E%9C"><span class="toc-number">2.0.5.1.</span> <span class="toc-text">è¿è¡Œç»“æœ:</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B%E3%80%81%E7%BA%BF%E7%A8%8B%E5%AF%B9%E6%AF%94"><span class="toc-number">3.</span> <span class="toc-text">è¿›ç¨‹ã€çº¿ç¨‹å¯¹æ¯”</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%9F%E8%83%BD"><span class="toc-number">3.0.1.</span> <span class="toc-text">åŠŸèƒ½</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E7%9A%84%E4%B8%8D%E5%90%8C"><span class="toc-number">3.0.2.</span> <span class="toc-text">å®šä¹‰çš„ä¸åŒ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8C%BA%E5%88%AB"><span class="toc-number">3.0.3.</span> <span class="toc-text">åŒºåˆ«</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="toc-number">3.0.4.</span> <span class="toc-text">ä¼˜ç¼ºç‚¹</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1-Queue"><span class="toc-number">4.</span> <span class="toc-text">è¿›ç¨‹é—´é€šä¿¡-Queue</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-Queue%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">4.0.1.</span> <span class="toc-text">1. Queueçš„ä½¿ç”¨</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%AF%B4%E6%98%8E-1"><span class="toc-number">4.0.1.0.1.</span> <span class="toc-text">è¯´æ˜</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Queue%E5%AE%9E%E4%BE%8B"><span class="toc-number">4.0.2.</span> <span class="toc-text">2. Queueå®ä¾‹</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B%E6%B1%A0Pool"><span class="toc-number">5.</span> <span class="toc-text">è¿›ç¨‹æ± Pool</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B%E6%B1%A0%E4%B8%AD%E7%9A%84Queue"><span class="toc-number">5.1.</span> <span class="toc-text">è¿›ç¨‹æ± ä¸­çš„Queue</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%EF%BC%9A%E6%96%87%E4%BB%B6%E5%A4%B9copy%E5%99%A8%EF%BC%88%E5%A4%9A%E8%BF%9B%E7%A8%8B%E7%89%88%EF%BC%89"><span class="toc-number">6.</span> <span class="toc-text">åº”ç”¨ï¼šæ–‡ä»¶å¤¹copyå™¨ï¼ˆå¤šè¿›ç¨‹ç‰ˆï¼‰</span></a></li></ol></div></div></div><div class="tag-cloud"><div class="tag-cloud-tags"><a href="/tags/57%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA/" style="font-size: 12px; color: #999">57æ­¥è¿›ç”µæœº</a> <a href="/tags/AT9SPro/" style="font-size: 12px; color: #999">AT9SPro</a> <a href="/tags/Anaconda/" style="font-size: 12px; color: #999">Anaconda</a> <a href="/tags/Arduino/" style="font-size: 24px; color: #3383cd">Arduino</a> <a href="/tags/CUDA/" style="font-size: 18px; color: #668eb3">CUDA</a> <a href="/tags/CUDNN/" style="font-size: 12px; color: #999">CUDNN</a> <a href="/tags/Conda/" style="font-size: 12px; color: #999">Conda</a> <a href="/tags/DHT11/" style="font-size: 12px; color: #999">DHT11</a> <a href="/tags/Docker/" style="font-size: 18px; color: #668eb3">Docker</a> <a href="/tags/ESP8266/" style="font-size: 12px; color: #999">ESP8266</a> <a href="/tags/GPIO/" style="font-size: 30px; color: #0078e7">GPIO</a> <a href="/tags/GPS/" style="font-size: 12px; color: #999">GPS</a> <a href="/tags/GPU/" style="font-size: 24px; color: #3383cd">GPU</a> <a href="/tags/HC-05/" style="font-size: 12px; color: #999">HC-05</a> <a href="/tags/HTML/" style="font-size: 18px; color: #668eb3">HTML</a> <a href="/tags/Hexo/" style="font-size: 18px; color: #668eb3">Hexo</a> <a href="/tags/Hexo%E5%AE%89%E8%A3%85/" style="font-size: 24px; color: #3383cd">Hexoå®‰è£…</a> <a href="/tags/IAR%E8%BD%AF%E4%BB%B6/" style="font-size: 12px; color: #999">IARè½¯ä»¶</a> <a href="/tags/JavaScript/" style="font-size: 18px; color: #668eb3">JavaScript</a> <a href="/tags/Json/" style="font-size: 12px; color: #999">Json</a></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article" style="--smc-primary:#6200ee;"><link itemprop="mainEntityOfPage" href="http://ccsu.top/posts/b23c6bbe/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="Explorer"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="explorerã®åšå®¢"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">Pythonå¤šä»»åŠ¡-è¿›ç¨‹</h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-line"></use></svg></span> <span class="post-meta-icon-text">Posted on</span> <time title="Created: 2022-03-20 00:53:00" itemprop="dateCreated datePublished" datetime="2022-03-20T00:53:00+08:00">2022-03-20</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="Word count in article"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-file-word-line"></use></svg></span> <span title="Word count in article">3.5k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="Reading time"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-timer-line"></use></svg></span> <span title="Reading time">14m</span></span></span><span class="post-busuanzi"><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="Views"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-eye-line"></use></svg> <span id="busuanzi_value_page_pv"></span></span></span><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-line"></use></svg></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/Python/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">Python</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/%E8%BF%9B%E7%A8%8B/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">è¿›ç¨‹</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body"><h1 id="è¿›ç¨‹ä»¥åŠçŠ¶æ€"><a href="#è¿›ç¨‹ä»¥åŠçŠ¶æ€" class="headerlink" title="è¿›ç¨‹ä»¥åŠçŠ¶æ€"></a>è¿›ç¨‹ä»¥åŠçŠ¶æ€</h1><h3 id="1-è¿›ç¨‹"><a href="#1-è¿›ç¨‹" class="headerlink" title="1. è¿›ç¨‹"></a>1. è¿›ç¨‹</h3><p>ç¨‹åºï¼šä¾‹å¦‚xxx.pyè¿™æ˜¯ç¨‹åºï¼Œæ˜¯ä¸€ä¸ªé™æ€çš„</p>
<p>è¿›ç¨‹ï¼šä¸€ä¸ªç¨‹åºè¿è¡Œèµ·æ¥åï¼Œä»£ç +ç”¨åˆ°çš„èµ„æº ç§°ä¹‹ä¸ºè¿›ç¨‹ï¼Œå®ƒæ˜¯æ“ä½œç³»ç»Ÿåˆ†é…èµ„æºçš„åŸºæœ¬å•å…ƒã€‚</p>
<p>ä¸ä»…å¯ä»¥é€šè¿‡çº¿ç¨‹å®Œæˆå¤šä»»åŠ¡ï¼Œè¿›ç¨‹ä¹Ÿæ˜¯å¯ä»¥çš„</p>
<h3 id="2-è¿›ç¨‹çš„çŠ¶æ€"><a href="#2-è¿›ç¨‹çš„çŠ¶æ€" class="headerlink" title="2. è¿›ç¨‹çš„çŠ¶æ€"></a>2. è¿›ç¨‹çš„çŠ¶æ€</h3><p>å·¥ä½œä¸­ï¼Œä»»åŠ¡æ•°å¾€å¾€å¤§äºcpuçš„æ ¸æ•°ï¼Œå³ä¸€å®šæœ‰ä¸€äº›ä»»åŠ¡æ­£åœ¨æ‰§è¡Œï¼Œè€Œå¦å¤–ä¸€äº›ä»»åŠ¡åœ¨ç­‰å¾…cpuè¿›è¡Œæ‰§è¡Œï¼Œå› æ­¤å¯¼è‡´äº†æœ‰äº†ä¸åŒçš„çŠ¶æ€</p>
<p><img src="https://raw.githubusercontent.com/wushuai2000/PicGo/main/img/20220319220239.png" alt="img" loading="lazy"></p>
<ul>
<li>å°±ç»ªæ€ï¼šè¿è¡Œçš„æ¡ä»¶éƒ½å·²ç»æ…¢å»ï¼Œæ­£åœ¨ç­‰åœ¨cpuæ‰§è¡Œ</li>
<li>æ‰§è¡Œæ€ï¼šcpuæ­£åœ¨æ‰§è¡Œå…¶åŠŸèƒ½</li>
<li>ç­‰å¾…æ€ï¼šç­‰å¾…æŸäº›æ¡ä»¶æ»¡è¶³ï¼Œä¾‹å¦‚ä¸€ä¸ªç¨‹åºsleepäº†ï¼Œæ­¤æ—¶å°±å¤„äºç­‰å¾…æ€</li>
</ul>
<h1 id="è¿›ç¨‹çš„åˆ›å»º-multiprocessing"><a href="#è¿›ç¨‹çš„åˆ›å»º-multiprocessing" class="headerlink" title="è¿›ç¨‹çš„åˆ›å»º-multiprocessing"></a>è¿›ç¨‹çš„åˆ›å»º-multiprocessing</h1><p>multiprocessingæ¨¡å—å°±æ˜¯è·¨å¹³å°ç‰ˆæœ¬çš„å¤šè¿›ç¨‹æ¨¡å—ï¼Œæä¾›äº†ä¸€ä¸ªProcessç±»æ¥ä»£è¡¨ä¸€ä¸ªè¿›ç¨‹å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡å¯ä»¥ç†è§£ä¸ºæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„è¿›ç¨‹ï¼Œå¯ä»¥æ‰§è¡Œå¦å¤–çš„äº‹æƒ…</p>
<h3 id="1-2ä¸ªwhileå¾ªç¯ä¸€èµ·æ‰§è¡Œ"><a href="#1-2ä¸ªwhileå¾ªç¯ä¸€èµ·æ‰§è¡Œ" class="headerlink" title="1. 2ä¸ªwhileå¾ªç¯ä¸€èµ·æ‰§è¡Œ"></a>1. 2ä¸ªwhileå¾ªç¯ä¸€èµ·æ‰§è¡Œ</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding:utf-8 -*-</span>
<span class="token keyword">from</span> multiprocessing <span class="token keyword">import</span> Process
<span class="token keyword">import</span> time


<span class="token keyword">def</span> <span class="token function">run_proc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""å­è¿›ç¨‹è¦æ‰§è¡Œçš„ä»£ç """</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"----2----"</span><span class="token punctuation">)</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__<span class="token operator">==</span><span class="token string">'__main__'</span><span class="token punctuation">:</span>
    p <span class="token operator">=</span> Process<span class="token punctuation">(</span>target<span class="token operator">=</span>run_proc<span class="token punctuation">)</span>
    p<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"----1----"</span><span class="token punctuation">)</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="è¯´æ˜"><a href="#è¯´æ˜" class="headerlink" title="è¯´æ˜"></a>è¯´æ˜</h4><ul>
<li>åˆ›å»ºå­è¿›ç¨‹æ—¶ï¼Œåªéœ€è¦ä¼ å…¥ä¸€ä¸ªæ‰§è¡Œå‡½æ•°å’Œå‡½æ•°çš„å‚æ•°ï¼Œåˆ›å»ºä¸€ä¸ªProcesså®ä¾‹ï¼Œç”¨start()æ–¹æ³•å¯åŠ¨</li>
</ul>
<h3 id="2-è¿›ç¨‹pid"><a href="#2-è¿›ç¨‹pid" class="headerlink" title="2. è¿›ç¨‹pid"></a>2. è¿›ç¨‹pid</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding:utf-8 -*-</span>
<span class="token keyword">from</span> multiprocessing <span class="token keyword">import</span> Process
<span class="token keyword">import</span> os
<span class="token keyword">import</span> time

<span class="token keyword">def</span> <span class="token function">run_proc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""å­è¿›ç¨‹è¦æ‰§è¡Œçš„ä»£ç """</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'å­è¿›ç¨‹è¿è¡Œä¸­ï¼Œpid=%d...'</span> <span class="token operator">%</span> os<span class="token punctuation">.</span>getpid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># os.getpidè·å–å½“å‰è¿›ç¨‹çš„è¿›ç¨‹å·</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'å­è¿›ç¨‹å°†è¦ç»“æŸ...'</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'çˆ¶è¿›ç¨‹pid: %d'</span> <span class="token operator">%</span> os<span class="token punctuation">.</span>getpid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># os.getpidè·å–å½“å‰è¿›ç¨‹çš„è¿›ç¨‹å·</span>
    p <span class="token operator">=</span> Process<span class="token punctuation">(</span>target<span class="token operator">=</span>run_proc<span class="token punctuation">)</span>
    p<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="3-Processè¯­æ³•ç»“æ„å¦‚ä¸‹ï¼š"><a href="#3-Processè¯­æ³•ç»“æ„å¦‚ä¸‹ï¼š" class="headerlink" title="3. Processè¯­æ³•ç»“æ„å¦‚ä¸‹ï¼š"></a>3. Processè¯­æ³•ç»“æ„å¦‚ä¸‹ï¼š</h3><p>Process([group [, target [, name [, args [, kwargs]]]]])</p>
<ul>
<li>targetï¼šå¦‚æœä¼ é€’äº†å‡½æ•°çš„å¼•ç”¨ï¼Œå¯ä»¥ä»»åŠ¡è¿™ä¸ªå­è¿›ç¨‹å°±æ‰§è¡Œè¿™é‡Œçš„ä»£ç </li>
<li>argsï¼šç»™targetæŒ‡å®šçš„å‡½æ•°ä¼ é€’çš„å‚æ•°ï¼Œä»¥å…ƒç»„çš„æ–¹å¼ä¼ é€’</li>
<li>kwargsï¼šç»™targetæŒ‡å®šçš„å‡½æ•°ä¼ é€’å‘½åå‚æ•°</li>
<li>nameï¼šç»™è¿›ç¨‹è®¾å®šä¸€ä¸ªåå­—ï¼Œå¯ä»¥ä¸è®¾å®š</li>
<li>groupï¼šæŒ‡å®šè¿›ç¨‹ç»„ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹ç”¨ä¸åˆ°</li>
</ul>
<p>Processåˆ›å»ºçš„å®ä¾‹å¯¹è±¡çš„å¸¸ç”¨æ–¹æ³•ï¼š</p>
<ul>
<li>start()ï¼šå¯åŠ¨å­è¿›ç¨‹å®ä¾‹ï¼ˆåˆ›å»ºå­è¿›ç¨‹ï¼‰</li>
<li>is_alive()ï¼šåˆ¤æ–­è¿›ç¨‹å­è¿›ç¨‹æ˜¯å¦è¿˜åœ¨æ´»ç€</li>
<li>join([timeout])ï¼šæ˜¯å¦ç­‰å¾…å­è¿›ç¨‹æ‰§è¡Œç»“æŸï¼Œæˆ–ç­‰å¾…å¤šå°‘ç§’</li>
<li>terminate()ï¼šä¸ç®¡ä»»åŠ¡æ˜¯å¦å®Œæˆï¼Œç«‹å³ç»ˆæ­¢å­è¿›ç¨‹</li>
</ul>
<p>Processåˆ›å»ºçš„å®ä¾‹å¯¹è±¡çš„å¸¸ç”¨å±æ€§ï¼š</p>
<ul>
<li>nameï¼šå½“å‰è¿›ç¨‹çš„åˆ«åï¼Œé»˜è®¤ä¸ºProcess-Nï¼ŒNä¸ºä»1å¼€å§‹é€’å¢çš„æ•´æ•°</li>
<li>pidï¼šå½“å‰è¿›ç¨‹çš„pidï¼ˆè¿›ç¨‹å·ï¼‰</li>
</ul>
<h3 id="4-ç»™å­è¿›ç¨‹æŒ‡å®šçš„å‡½æ•°ä¼ é€’å‚æ•°"><a href="#4-ç»™å­è¿›ç¨‹æŒ‡å®šçš„å‡½æ•°ä¼ é€’å‚æ•°" class="headerlink" title="4. ç»™å­è¿›ç¨‹æŒ‡å®šçš„å‡½æ•°ä¼ é€’å‚æ•°"></a>4. ç»™å­è¿›ç¨‹æŒ‡å®šçš„å‡½æ•°ä¼ é€’å‚æ•°</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding:utf-8 -*-</span>
<span class="token keyword">from</span> multiprocessing <span class="token keyword">import</span> Process
<span class="token keyword">import</span> os
<span class="token keyword">from</span> time <span class="token keyword">import</span> sleep


<span class="token keyword">def</span> <span class="token function">run_proc</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'å­è¿›ç¨‹è¿è¡Œä¸­ï¼Œname= %s,age=%d ,pid=%d...'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> os<span class="token punctuation">.</span>getpid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>kwargs<span class="token punctuation">)</span>
        sleep<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__<span class="token operator">==</span><span class="token string">'__main__'</span><span class="token punctuation">:</span>
    p <span class="token operator">=</span> Process<span class="token punctuation">(</span>target<span class="token operator">=</span>run_proc<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'test'</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">,</span> kwargs<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"m"</span><span class="token punctuation">:</span><span class="token number">20</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    p<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
    sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># 1ç§’ä¸­ä¹‹åï¼Œç«‹å³ç»“æŸå­è¿›ç¨‹</span>
    p<span class="token punctuation">.</span>terminate<span class="token punctuation">(</span><span class="token punctuation">)</span>
    p<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿è¡Œç»“æœ:</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">å­è¿›ç¨‹è¿è¡Œä¸­ï¼Œname<span class="token operator">=</span> test<span class="token punctuation">,</span>age<span class="token operator">=</span><span class="token number">18</span> <span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">45097.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">&#123;</span><span class="token string">'m'</span><span class="token punctuation">:</span> <span class="token number">20</span><span class="token punctuation">&#125;</span>
å­è¿›ç¨‹è¿è¡Œä¸­ï¼Œname<span class="token operator">=</span> test<span class="token punctuation">,</span>age<span class="token operator">=</span><span class="token number">18</span> <span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">45097.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">&#123;</span><span class="token string">'m'</span><span class="token punctuation">:</span> <span class="token number">20</span><span class="token punctuation">&#125;</span>
å­è¿›ç¨‹è¿è¡Œä¸­ï¼Œname<span class="token operator">=</span> test<span class="token punctuation">,</span>age<span class="token operator">=</span><span class="token number">18</span> <span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">45097.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">&#123;</span><span class="token string">'m'</span><span class="token punctuation">:</span> <span class="token number">20</span><span class="token punctuation">&#125;</span>
å­è¿›ç¨‹è¿è¡Œä¸­ï¼Œname<span class="token operator">=</span> test<span class="token punctuation">,</span>age<span class="token operator">=</span><span class="token number">18</span> <span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">45097.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">&#123;</span><span class="token string">'m'</span><span class="token punctuation">:</span> <span class="token number">20</span><span class="token punctuation">&#125;</span>
å­è¿›ç¨‹è¿è¡Œä¸­ï¼Œname<span class="token operator">=</span> test<span class="token punctuation">,</span>age<span class="token operator">=</span><span class="token number">18</span> <span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">45097.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">&#123;</span><span class="token string">'m'</span><span class="token punctuation">:</span> <span class="token number">20</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="5-è¿›ç¨‹é—´ä¸åŒäº«å…¨å±€å˜é‡"><a href="#5-è¿›ç¨‹é—´ä¸åŒäº«å…¨å±€å˜é‡" class="headerlink" title="5. è¿›ç¨‹é—´ä¸åŒäº«å…¨å±€å˜é‡"></a>5. è¿›ç¨‹é—´ä¸åŒäº«å…¨å±€å˜é‡</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding:utf-8 -*-</span>
<span class="token keyword">from</span> multiprocessing <span class="token keyword">import</span> Process
<span class="token keyword">import</span> os
<span class="token keyword">import</span> time

nums <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">]</span>

<span class="token keyword">def</span> <span class="token function">work1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""å­è¿›ç¨‹è¦æ‰§è¡Œçš„ä»£ç """</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"in process1 pid=%d ,nums=%s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>os<span class="token punctuation">.</span>getpid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nums<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        nums<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"in process1 pid=%d ,nums=%s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>os<span class="token punctuation">.</span>getpid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nums<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">work2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""å­è¿›ç¨‹è¦æ‰§è¡Œçš„ä»£ç """</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"in process2 pid=%d ,nums=%s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>os<span class="token punctuation">.</span>getpid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nums<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    p1 <span class="token operator">=</span> Process<span class="token punctuation">(</span>target<span class="token operator">=</span>work1<span class="token punctuation">)</span>
    p1<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
    p1<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">)</span>

    p2 <span class="token operator">=</span> Process<span class="token punctuation">(</span>target<span class="token operator">=</span>work2<span class="token punctuation">)</span>
    p2<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="è¿è¡Œç»“æœ"><a href="#è¿è¡Œç»“æœ" class="headerlink" title="è¿è¡Œç»“æœ:"></a>è¿è¡Œç»“æœ:</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">in</span> process1 pid<span class="token operator">=</span><span class="token number">11349</span> <span class="token punctuation">,</span>nums<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">]</span>
<span class="token keyword">in</span> process1 pid<span class="token operator">=</span><span class="token number">11349</span> <span class="token punctuation">,</span>nums<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>
<span class="token keyword">in</span> process1 pid<span class="token operator">=</span><span class="token number">11349</span> <span class="token punctuation">,</span>nums<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>
<span class="token keyword">in</span> process1 pid<span class="token operator">=</span><span class="token number">11349</span> <span class="token punctuation">,</span>nums<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>
<span class="token keyword">in</span> process2 pid<span class="token operator">=</span><span class="token number">11350</span> <span class="token punctuation">,</span>nums<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h1 id="è¿›ç¨‹ã€çº¿ç¨‹å¯¹æ¯”"><a href="#è¿›ç¨‹ã€çº¿ç¨‹å¯¹æ¯”" class="headerlink" title="è¿›ç¨‹ã€çº¿ç¨‹å¯¹æ¯”"></a>è¿›ç¨‹ã€çº¿ç¨‹å¯¹æ¯”</h1><h3 id="åŠŸèƒ½"><a href="#åŠŸèƒ½" class="headerlink" title="åŠŸèƒ½"></a>åŠŸèƒ½</h3><ul>
<li>è¿›ç¨‹ï¼Œèƒ½å¤Ÿå®Œæˆå¤šä»»åŠ¡ï¼Œæ¯”å¦‚ åœ¨ä¸€å°ç”µè„‘ä¸Šèƒ½å¤ŸåŒæ—¶è¿è¡Œå¤šä¸ªQQ</li>
<li>çº¿ç¨‹ï¼Œèƒ½å¤Ÿå®Œæˆå¤šä»»åŠ¡ï¼Œæ¯”å¦‚ ä¸€ä¸ªQQä¸­çš„å¤šä¸ªèŠå¤©çª—å£</li>
</ul>
<p><img src="https://raw.githubusercontent.com/wushuai2000/PicGo/main/img/20220319221932.jpg" alt="img" loading="lazy"></p>
<h3 id="å®šä¹‰çš„ä¸åŒ"><a href="#å®šä¹‰çš„ä¸åŒ" class="headerlink" title="å®šä¹‰çš„ä¸åŒ"></a>å®šä¹‰çš„ä¸åŒ</h3><ul>
<li>è¿›ç¨‹æ˜¯ç³»ç»Ÿè¿›è¡Œèµ„æºåˆ†é…å’Œè°ƒåº¦çš„ä¸€ä¸ªç‹¬ç«‹å•ä½.</li>
<li>çº¿ç¨‹æ˜¯è¿›ç¨‹çš„ä¸€ä¸ªå®ä½“,æ˜¯CPUè°ƒåº¦å’Œåˆ†æ´¾çš„åŸºæœ¬å•ä½,å®ƒæ˜¯æ¯”è¿›ç¨‹æ›´å°çš„èƒ½ç‹¬ç«‹è¿è¡Œçš„åŸºæœ¬å•ä½.çº¿ç¨‹è‡ªå·±åŸºæœ¬ä¸Šä¸æ‹¥æœ‰ç³»ç»Ÿèµ„æº,åªæ‹¥æœ‰ä¸€ç‚¹åœ¨è¿è¡Œä¸­å¿…ä¸å¯å°‘çš„èµ„æº(å¦‚ç¨‹åºè®¡æ•°å™¨,ä¸€ç»„å¯„å­˜å™¨å’Œæ ˆ),ä½†æ˜¯å®ƒå¯ä¸åŒå±ä¸€ä¸ªè¿›ç¨‹çš„å…¶ä»–çš„çº¿ç¨‹å…±äº«è¿›ç¨‹æ‰€æ‹¥æœ‰çš„å…¨éƒ¨èµ„æº.</li>
</ul>
<h3 id="åŒºåˆ«"><a href="#åŒºåˆ«" class="headerlink" title="åŒºåˆ«"></a>åŒºåˆ«</h3><ul>
<li>ä¸€ä¸ªç¨‹åºè‡³å°‘æœ‰ä¸€ä¸ªè¿›ç¨‹,ä¸€ä¸ªè¿›ç¨‹è‡³å°‘æœ‰ä¸€ä¸ªçº¿ç¨‹.</li>
<li>çº¿ç¨‹çš„åˆ’åˆ†å°ºåº¦å°äºè¿›ç¨‹(èµ„æºæ¯”è¿›ç¨‹å°‘)ï¼Œä½¿å¾—å¤šçº¿ç¨‹ç¨‹åºçš„å¹¶å‘æ€§é«˜ã€‚</li>
<li>è¿›ç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­æ‹¥æœ‰ç‹¬ç«‹çš„å†…å­˜å•å…ƒï¼Œè€Œå¤šä¸ªçº¿ç¨‹å…±äº«å†…å­˜ï¼Œä»è€Œæå¤§åœ°æé«˜äº†ç¨‹åºçš„è¿è¡Œæ•ˆç‡</li>
</ul>
<p><img src="https://raw.githubusercontent.com/wushuai2000/PicGo/main/img/20220319221950.png" alt="img" loading="lazy"></p>
<ul>
<li>çº¿çº¿ç¨‹ä¸èƒ½å¤Ÿç‹¬ç«‹æ‰§è¡Œï¼Œå¿…é¡»ä¾å­˜åœ¨è¿›ç¨‹ä¸­</li>
<li>å¯ä»¥å°†è¿›ç¨‹ç†è§£ä¸ºå·¥å‚ä¸­çš„ä¸€æ¡æµæ°´çº¿ï¼Œè€Œå…¶ä¸­çš„çº¿ç¨‹å°±æ˜¯è¿™ä¸ªæµæ°´çº¿ä¸Šçš„å·¥äºº</li>
</ul>
<p><img src="https://raw.githubusercontent.com/wushuai2000/PicGo/main/img/20220319222001.gif" alt="img" loading="lazy"></p>
<h3 id="ä¼˜ç¼ºç‚¹"><a href="#ä¼˜ç¼ºç‚¹" class="headerlink" title="ä¼˜ç¼ºç‚¹"></a>ä¼˜ç¼ºç‚¹</h3><p>çº¿ç¨‹å’Œè¿›ç¨‹åœ¨ä½¿ç”¨ä¸Šå„æœ‰ä¼˜ç¼ºç‚¹ï¼šçº¿ç¨‹æ‰§è¡Œå¼€é”€å°ï¼Œä½†ä¸åˆ©äºèµ„æºçš„ç®¡ç†å’Œä¿æŠ¤ï¼›è€Œè¿›ç¨‹æ­£ç›¸åã€‚</p>
<h1 id="è¿›ç¨‹é—´é€šä¿¡-Queue"><a href="#è¿›ç¨‹é—´é€šä¿¡-Queue" class="headerlink" title="è¿›ç¨‹é—´é€šä¿¡-Queue"></a>è¿›ç¨‹é—´é€šä¿¡-Queue</h1><p>Processä¹‹é—´æœ‰æ—¶éœ€è¦é€šä¿¡ï¼Œæ“ä½œç³»ç»Ÿæä¾›äº†å¾ˆå¤šæœºåˆ¶æ¥å®ç°è¿›ç¨‹é—´çš„é€šä¿¡ã€‚</p>
<h3 id="1-Queueçš„ä½¿ç”¨"><a href="#1-Queueçš„ä½¿ç”¨" class="headerlink" title="1. Queueçš„ä½¿ç”¨"></a>1. Queueçš„ä½¿ç”¨</h3><p>å¯ä»¥ä½¿ç”¨multiprocessingæ¨¡å—çš„Queueå®ç°å¤šè¿›ç¨‹ä¹‹é—´çš„æ•°æ®ä¼ é€’ï¼ŒQueueæœ¬èº«æ˜¯ä¸€ä¸ªæ¶ˆæ¯åˆ—é˜Ÿç¨‹åºï¼Œé¦–å…ˆç”¨ä¸€ä¸ªå°å®ä¾‹æ¥æ¼”ç¤ºä¸€ä¸‹Queueçš„å·¥ä½œåŸç†ï¼š</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#coding=utf-8</span>
<span class="token keyword">from</span> multiprocessing <span class="token keyword">import</span> Queue
q<span class="token operator">=</span>Queue<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token comment">#åˆå§‹åŒ–ä¸€ä¸ªQueueå¯¹è±¡ï¼Œæœ€å¤šå¯æ¥æ”¶ä¸‰æ¡putæ¶ˆæ¯</span>
q<span class="token punctuation">.</span>put<span class="token punctuation">(</span><span class="token string">"æ¶ˆæ¯1"</span><span class="token punctuation">)</span> 
q<span class="token punctuation">.</span>put<span class="token punctuation">(</span><span class="token string">"æ¶ˆæ¯2"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>q<span class="token punctuation">.</span>full<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">#False</span>
q<span class="token punctuation">.</span>put<span class="token punctuation">(</span><span class="token string">"æ¶ˆæ¯3"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>q<span class="token punctuation">.</span>full<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">#True</span>

<span class="token comment">#å› ä¸ºæ¶ˆæ¯åˆ—é˜Ÿå·²æ»¡ä¸‹é¢çš„tryéƒ½ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œç¬¬ä¸€ä¸ªtryä¼šç­‰å¾…2ç§’åå†æŠ›å‡ºå¼‚å¸¸ï¼Œç¬¬äºŒä¸ªTryä¼šç«‹åˆ»æŠ›å‡ºå¼‚å¸¸</span>
<span class="token keyword">try</span><span class="token punctuation">:</span>
    q<span class="token punctuation">.</span>put<span class="token punctuation">(</span><span class="token string">"æ¶ˆæ¯4"</span><span class="token punctuation">,</span><span class="token boolean">True</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token keyword">except</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"æ¶ˆæ¯åˆ—é˜Ÿå·²æ»¡ï¼Œç°æœ‰æ¶ˆæ¯æ•°é‡:%s"</span><span class="token operator">%</span>q<span class="token punctuation">.</span>qsize<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">try</span><span class="token punctuation">:</span>
    q<span class="token punctuation">.</span>put_nowait<span class="token punctuation">(</span><span class="token string">"æ¶ˆæ¯4"</span><span class="token punctuation">)</span>
<span class="token keyword">except</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"æ¶ˆæ¯åˆ—é˜Ÿå·²æ»¡ï¼Œç°æœ‰æ¶ˆæ¯æ•°é‡:%s"</span><span class="token operator">%</span>q<span class="token punctuation">.</span>qsize<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">#æ¨èçš„æ–¹å¼ï¼Œå…ˆåˆ¤æ–­æ¶ˆæ¯åˆ—é˜Ÿæ˜¯å¦å·²æ»¡ï¼Œå†å†™å…¥</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> q<span class="token punctuation">.</span>full<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    q<span class="token punctuation">.</span>put_nowait<span class="token punctuation">(</span><span class="token string">"æ¶ˆæ¯4"</span><span class="token punctuation">)</span>

<span class="token comment">#è¯»å–æ¶ˆæ¯æ—¶ï¼Œå…ˆåˆ¤æ–­æ¶ˆæ¯åˆ—é˜Ÿæ˜¯å¦ä¸ºç©ºï¼Œå†è¯»å–</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> q<span class="token punctuation">.</span>empty<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>q<span class="token punctuation">.</span>qsize<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>q<span class="token punctuation">.</span>get_nowait<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿è¡Œç»“æœ:</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token boolean">False</span>
<span class="token boolean">True</span>
æ¶ˆæ¯åˆ—é˜Ÿå·²æ»¡ï¼Œç°æœ‰æ¶ˆæ¯æ•°é‡<span class="token punctuation">:</span><span class="token number">3</span>
æ¶ˆæ¯åˆ—é˜Ÿå·²æ»¡ï¼Œç°æœ‰æ¶ˆæ¯æ•°é‡<span class="token punctuation">:</span><span class="token number">3</span>
æ¶ˆæ¯<span class="token number">1</span>
æ¶ˆæ¯<span class="token number">2</span>
æ¶ˆæ¯<span class="token number">3</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="è¯´æ˜-1"><a href="#è¯´æ˜-1" class="headerlink" title="è¯´æ˜"></a>è¯´æ˜</h5><p>åˆå§‹åŒ–Queue()å¯¹è±¡æ—¶ï¼ˆä¾‹å¦‚ï¼šq&#x3D;Queue()ï¼‰ï¼Œè‹¥æ‹¬å·ä¸­æ²¡æœ‰æŒ‡å®šæœ€å¤§å¯æ¥æ”¶çš„æ¶ˆæ¯æ•°é‡ï¼Œæˆ–æ•°é‡ä¸ºè´Ÿå€¼ï¼Œé‚£ä¹ˆå°±ä»£è¡¨å¯æ¥å—çš„æ¶ˆæ¯æ•°é‡æ²¡æœ‰ä¸Šé™ï¼ˆç›´åˆ°å†…å­˜çš„å°½å¤´ï¼‰ï¼›</p>
<ul>
<li>Queue.qsize()ï¼šè¿”å›å½“å‰é˜Ÿåˆ—åŒ…å«çš„æ¶ˆæ¯æ•°é‡ï¼›</li>
<li>Queue.empty()ï¼šå¦‚æœé˜Ÿåˆ—ä¸ºç©ºï¼Œè¿”å›Trueï¼Œåä¹‹False ï¼›</li>
<li>Queue.full()ï¼šå¦‚æœé˜Ÿåˆ—æ»¡äº†ï¼Œè¿”å›True,åä¹‹Falseï¼›</li>
<li>Queue.get([block[, timeout]])ï¼šè·å–é˜Ÿåˆ—ä¸­çš„ä¸€æ¡æ¶ˆæ¯ï¼Œç„¶åå°†å…¶ä»åˆ—é˜Ÿä¸­ç§»é™¤ï¼Œblocké»˜è®¤å€¼ä¸ºTrueï¼›</li>
</ul>
<p>1ï¼‰å¦‚æœblockä½¿ç”¨é»˜è®¤å€¼ï¼Œä¸”æ²¡æœ‰è®¾ç½®timeoutï¼ˆå•ä½ç§’ï¼‰ï¼Œæ¶ˆæ¯åˆ—é˜Ÿå¦‚æœä¸ºç©ºï¼Œæ­¤æ—¶ç¨‹åºå°†è¢«é˜»å¡ï¼ˆåœåœ¨è¯»å–çŠ¶æ€ï¼‰ï¼Œç›´åˆ°ä»æ¶ˆæ¯åˆ—é˜Ÿè¯»åˆ°æ¶ˆæ¯ä¸ºæ­¢ï¼Œå¦‚æœè®¾ç½®äº†timeoutï¼Œåˆ™ä¼šç­‰å¾…timeoutç§’ï¼Œè‹¥è¿˜æ²¡è¯»å–åˆ°ä»»ä½•æ¶ˆæ¯ï¼Œåˆ™æŠ›å‡ºâ€Queue.Emptyâ€å¼‚å¸¸ï¼›</p>
<p>2ï¼‰å¦‚æœblockå€¼ä¸ºFalseï¼Œæ¶ˆæ¯åˆ—é˜Ÿå¦‚æœä¸ºç©ºï¼Œåˆ™ä¼šç«‹åˆ»æŠ›å‡ºâ€Queue.Emptyâ€å¼‚å¸¸ï¼›</p>
<ul>
<li>Queue.get_nowait()ï¼šç›¸å½“Queue.get(False)ï¼›</li>
<li>Queue.put(item,[block[, timeout]])ï¼šå°†itemæ¶ˆæ¯å†™å…¥é˜Ÿåˆ—ï¼Œblocké»˜è®¤å€¼ä¸ºTrueï¼›</li>
</ul>
<p>1ï¼‰å¦‚æœblockä½¿ç”¨é»˜è®¤å€¼ï¼Œä¸”æ²¡æœ‰è®¾ç½®timeoutï¼ˆå•ä½ç§’ï¼‰ï¼Œæ¶ˆæ¯åˆ—é˜Ÿå¦‚æœå·²ç»æ²¡æœ‰ç©ºé—´å¯å†™å…¥ï¼Œæ­¤æ—¶ç¨‹åºå°†è¢«é˜»å¡ï¼ˆåœåœ¨å†™å…¥çŠ¶æ€ï¼‰ï¼Œç›´åˆ°ä»æ¶ˆæ¯åˆ—é˜Ÿè…¾å‡ºç©ºé—´ä¸ºæ­¢ï¼Œå¦‚æœè®¾ç½®äº†timeoutï¼Œåˆ™ä¼šç­‰å¾…timeoutç§’ï¼Œè‹¥è¿˜æ²¡ç©ºé—´ï¼Œåˆ™æŠ›å‡ºâ€Queue.Fullâ€å¼‚å¸¸ï¼›</p>
<p>2ï¼‰å¦‚æœblockå€¼ä¸ºFalseï¼Œæ¶ˆæ¯åˆ—é˜Ÿå¦‚æœæ²¡æœ‰ç©ºé—´å¯å†™å…¥ï¼Œåˆ™ä¼šç«‹åˆ»æŠ›å‡ºâ€Queue.Fullâ€å¼‚å¸¸ï¼›</p>
<ul>
<li>Queue.put_nowait(item)ï¼šç›¸å½“Queue.put(item, False)ï¼›</li>
</ul>
<h3 id="2-Queueå®ä¾‹"><a href="#2-Queueå®ä¾‹" class="headerlink" title="2. Queueå®ä¾‹"></a>2. Queueå®ä¾‹</h3><p>æˆ‘ä»¬ä»¥Queueä¸ºä¾‹ï¼Œåœ¨çˆ¶è¿›ç¨‹ä¸­åˆ›å»ºä¸¤ä¸ªå­è¿›ç¨‹ï¼Œä¸€ä¸ªå¾€Queueé‡Œå†™æ•°æ®ï¼Œä¸€ä¸ªä»Queueé‡Œè¯»æ•°æ®ï¼š</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> multiprocessing <span class="token keyword">import</span> Process<span class="token punctuation">,</span> Queue
<span class="token keyword">import</span> os<span class="token punctuation">,</span> time<span class="token punctuation">,</span> random

<span class="token comment"># å†™æ•°æ®è¿›ç¨‹æ‰§è¡Œçš„ä»£ç :</span>
<span class="token keyword">def</span> <span class="token function">write</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> value <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token string">'C'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Put %s to queue...'</span> <span class="token operator">%</span> value<span class="token punctuation">)</span>
        q<span class="token punctuation">.</span>put<span class="token punctuation">(</span>value<span class="token punctuation">)</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># è¯»æ•°æ®è¿›ç¨‹æ‰§è¡Œçš„ä»£ç :</span>
<span class="token keyword">def</span> <span class="token function">read</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> q<span class="token punctuation">.</span>empty<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            value <span class="token operator">=</span> q<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Get %s from queue.'</span> <span class="token operator">%</span> value<span class="token punctuation">)</span>
            time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">break</span>

<span class="token keyword">if</span> __name__<span class="token operator">==</span><span class="token string">'__main__'</span><span class="token punctuation">:</span>
    <span class="token comment"># çˆ¶è¿›ç¨‹åˆ›å»ºQueueï¼Œå¹¶ä¼ ç»™å„ä¸ªå­è¿›ç¨‹ï¼š</span>
    q <span class="token operator">=</span> Queue<span class="token punctuation">(</span><span class="token punctuation">)</span>
    pw <span class="token operator">=</span> Process<span class="token punctuation">(</span>target<span class="token operator">=</span>write<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span>q<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    pr <span class="token operator">=</span> Process<span class="token punctuation">(</span>target<span class="token operator">=</span>read<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span>q<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># å¯åŠ¨å­è¿›ç¨‹pwï¼Œå†™å…¥:</span>
    pw<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>    
    <span class="token comment"># ç­‰å¾…pwç»“æŸ:</span>
    pw<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># å¯åŠ¨å­è¿›ç¨‹prï¼Œè¯»å–:</span>
    pr<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
    pr<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># prè¿›ç¨‹é‡Œæ˜¯æ­»å¾ªç¯ï¼Œæ— æ³•ç­‰å¾…å…¶ç»“æŸï¼Œåªèƒ½å¼ºè¡Œç»ˆæ­¢:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'æ‰€æœ‰æ•°æ®éƒ½å†™å…¥å¹¶ä¸”è¯»å®Œ'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿è¡Œç»“æœï¼š</p>
<p><img src="https://raw.githubusercontent.com/wushuai2000/PicGo/main/img/20220319222345.gif" alt="img" loading="lazy"></p>
<h1 id="è¿›ç¨‹æ± Pool"><a href="#è¿›ç¨‹æ± Pool" class="headerlink" title="è¿›ç¨‹æ± Pool"></a>è¿›ç¨‹æ± Pool</h1><p>å½“éœ€è¦åˆ›å»ºçš„å­è¿›ç¨‹æ•°é‡ä¸å¤šæ—¶ï¼Œå¯ä»¥ç›´æ¥åˆ©ç”¨multiprocessingä¸­çš„ProcessåŠ¨æ€æˆç”Ÿå¤šä¸ªè¿›ç¨‹ï¼Œä½†å¦‚æœæ˜¯ä¸Šç™¾ç”šè‡³ä¸Šåƒä¸ªç›®æ ‡ï¼Œæ‰‹åŠ¨çš„å»åˆ›å»ºè¿›ç¨‹çš„å·¥ä½œé‡å·¨å¤§ï¼Œæ­¤æ—¶å°±å¯ä»¥ç”¨åˆ°multiprocessingæ¨¡å—æä¾›çš„Poolæ–¹æ³•ã€‚</p>
<p>åˆå§‹åŒ–Poolæ—¶ï¼Œå¯ä»¥æŒ‡å®šä¸€ä¸ªæœ€å¤§è¿›ç¨‹æ•°ï¼Œå½“æœ‰æ–°çš„è¯·æ±‚æäº¤åˆ°Poolä¸­æ—¶ï¼Œå¦‚æœæ± è¿˜æ²¡æœ‰æ»¡ï¼Œé‚£ä¹ˆå°±ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„è¿›ç¨‹ç”¨æ¥æ‰§è¡Œè¯¥è¯·æ±‚ï¼›ä½†å¦‚æœæ± ä¸­çš„è¿›ç¨‹æ•°å·²ç»è¾¾åˆ°æŒ‡å®šçš„æœ€å¤§å€¼ï¼Œé‚£ä¹ˆè¯¥è¯·æ±‚å°±ä¼šç­‰å¾…ï¼Œç›´åˆ°æ± ä¸­æœ‰è¿›ç¨‹ç»“æŸï¼Œæ‰ä¼šç”¨ä¹‹å‰çš„è¿›ç¨‹æ¥æ‰§è¡Œæ–°çš„ä»»åŠ¡ï¼Œè¯·çœ‹ä¸‹é¢çš„å®ä¾‹ï¼š</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding:utf-8 -*-</span>
<span class="token keyword">from</span> multiprocessing <span class="token keyword">import</span> Pool
<span class="token keyword">import</span> os<span class="token punctuation">,</span> time<span class="token punctuation">,</span> random

<span class="token keyword">def</span> <span class="token function">worker</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">:</span>
    t_start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"%så¼€å§‹æ‰§è¡Œ,è¿›ç¨‹å·ä¸º%d"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>msg<span class="token punctuation">,</span>os<span class="token punctuation">.</span>getpid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># random.random()éšæœºç”Ÿæˆ0~1ä¹‹é—´çš„æµ®ç‚¹æ•°</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">)</span> 
    t_stop <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>msg<span class="token punctuation">,</span><span class="token string">"æ‰§è¡Œå®Œæ¯•ï¼Œè€—æ—¶%0.2f"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>t_stop<span class="token operator">-</span>t_start<span class="token punctuation">)</span><span class="token punctuation">)</span>

po <span class="token operator">=</span> Pool<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>  <span class="token comment"># å®šä¹‰ä¸€ä¸ªè¿›ç¨‹æ± ï¼Œæœ€å¤§è¿›ç¨‹æ•°3</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># Pool().apply_async(è¦è°ƒç”¨çš„ç›®æ ‡,(ä¼ é€’ç»™ç›®æ ‡çš„å‚æ•°å…ƒç¥–,))</span>
    <span class="token comment"># æ¯æ¬¡å¾ªç¯å°†ä¼šç”¨ç©ºé—²å‡ºæ¥çš„å­è¿›ç¨‹å»è°ƒç”¨ç›®æ ‡</span>
    po<span class="token punctuation">.</span>apply_async<span class="token punctuation">(</span>worker<span class="token punctuation">,</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"----start----"</span><span class="token punctuation">)</span>
po<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># å…³é—­è¿›ç¨‹æ± ï¼Œå…³é—­åpoä¸å†æ¥æ”¶æ–°çš„è¯·æ±‚</span>
po<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># ç­‰å¾…poä¸­æ‰€æœ‰å­è¿›ç¨‹æ‰§è¡Œå®Œæˆï¼Œå¿…é¡»æ”¾åœ¨closeè¯­å¥ä¹‹å</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-----end-----"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿è¡Œç»“æœ:</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>start<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
<span class="token number">0</span>å¼€å§‹æ‰§è¡Œ<span class="token punctuation">,</span>è¿›ç¨‹å·ä¸º<span class="token number">21466</span>
<span class="token number">1</span>å¼€å§‹æ‰§è¡Œ<span class="token punctuation">,</span>è¿›ç¨‹å·ä¸º<span class="token number">21468</span>
<span class="token number">2</span>å¼€å§‹æ‰§è¡Œ<span class="token punctuation">,</span>è¿›ç¨‹å·ä¸º<span class="token number">21467</span>
<span class="token number">0</span> æ‰§è¡Œå®Œæ¯•ï¼Œè€—æ—¶<span class="token number">1.01</span>
<span class="token number">3</span>å¼€å§‹æ‰§è¡Œ<span class="token punctuation">,</span>è¿›ç¨‹å·ä¸º<span class="token number">21466</span>
<span class="token number">2</span> æ‰§è¡Œå®Œæ¯•ï¼Œè€—æ—¶<span class="token number">1.24</span>
<span class="token number">4</span>å¼€å§‹æ‰§è¡Œ<span class="token punctuation">,</span>è¿›ç¨‹å·ä¸º<span class="token number">21467</span>
<span class="token number">3</span> æ‰§è¡Œå®Œæ¯•ï¼Œè€—æ—¶<span class="token number">0.56</span>
<span class="token number">5</span>å¼€å§‹æ‰§è¡Œ<span class="token punctuation">,</span>è¿›ç¨‹å·ä¸º<span class="token number">21466</span>
<span class="token number">1</span> æ‰§è¡Œå®Œæ¯•ï¼Œè€—æ—¶<span class="token number">1.68</span>
<span class="token number">6</span>å¼€å§‹æ‰§è¡Œ<span class="token punctuation">,</span>è¿›ç¨‹å·ä¸º<span class="token number">21468</span>
<span class="token number">4</span> æ‰§è¡Œå®Œæ¯•ï¼Œè€—æ—¶<span class="token number">0.67</span>
<span class="token number">7</span>å¼€å§‹æ‰§è¡Œ<span class="token punctuation">,</span>è¿›ç¨‹å·ä¸º<span class="token number">21467</span>
<span class="token number">5</span> æ‰§è¡Œå®Œæ¯•ï¼Œè€—æ—¶<span class="token number">0.83</span>
<span class="token number">8</span>å¼€å§‹æ‰§è¡Œ<span class="token punctuation">,</span>è¿›ç¨‹å·ä¸º<span class="token number">21466</span>
<span class="token number">6</span> æ‰§è¡Œå®Œæ¯•ï¼Œè€—æ—¶<span class="token number">0.75</span>
<span class="token number">9</span>å¼€å§‹æ‰§è¡Œ<span class="token punctuation">,</span>è¿›ç¨‹å·ä¸º<span class="token number">21468</span>
<span class="token number">7</span> æ‰§è¡Œå®Œæ¯•ï¼Œè€—æ—¶<span class="token number">1.03</span>
<span class="token number">8</span> æ‰§è¡Œå®Œæ¯•ï¼Œè€—æ—¶<span class="token number">1.05</span>
<span class="token number">9</span> æ‰§è¡Œå®Œæ¯•ï¼Œè€—æ—¶<span class="token number">1.69</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>end<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>multiprocessing.Poolå¸¸ç”¨å‡½æ•°è§£æï¼š</p>
<ul>
<li>apply_async(func[, args[, kwds]]) ï¼šä½¿ç”¨éé˜»å¡æ–¹å¼è°ƒç”¨funcï¼ˆå¹¶è¡Œæ‰§è¡Œï¼Œå µå¡æ–¹å¼å¿…é¡»ç­‰å¾…ä¸Šä¸€ä¸ªè¿›ç¨‹é€€å‡ºæ‰èƒ½æ‰§è¡Œä¸‹ä¸€ä¸ªè¿›ç¨‹ï¼‰ï¼Œargsä¸ºä¼ é€’ç»™funcçš„å‚æ•°åˆ—è¡¨ï¼Œkwdsä¸ºä¼ é€’ç»™funcçš„å…³é”®å­—å‚æ•°åˆ—è¡¨ï¼›</li>
<li>close()ï¼šå…³é—­Poolï¼Œä½¿å…¶ä¸å†æ¥å—æ–°çš„ä»»åŠ¡ï¼›</li>
<li>terminate()ï¼šä¸ç®¡ä»»åŠ¡æ˜¯å¦å®Œæˆï¼Œç«‹å³ç»ˆæ­¢ï¼›</li>
<li>join()ï¼šä¸»è¿›ç¨‹é˜»å¡ï¼Œç­‰å¾…å­è¿›ç¨‹çš„é€€å‡ºï¼Œ å¿…é¡»åœ¨closeæˆ–terminateä¹‹åä½¿ç”¨ï¼›</li>
</ul>
<h2 id="è¿›ç¨‹æ± ä¸­çš„Queue"><a href="#è¿›ç¨‹æ± ä¸­çš„Queue" class="headerlink" title="è¿›ç¨‹æ± ä¸­çš„Queue"></a>è¿›ç¨‹æ± ä¸­çš„Queue</h2><p>å¦‚æœè¦ä½¿ç”¨Poolåˆ›å»ºè¿›ç¨‹ï¼Œå°±éœ€è¦ä½¿ç”¨multiprocessing.Manager()ä¸­çš„Queue()ï¼Œè€Œä¸æ˜¯multiprocessing.Queue()ï¼Œå¦åˆ™ä¼šå¾—åˆ°ä¸€æ¡å¦‚ä¸‹çš„é”™è¯¯ä¿¡æ¯ï¼š</p>
<p>RuntimeError: Queue objects should only be shared between processes through inheritance.</p>
<p>ä¸‹é¢çš„å®ä¾‹æ¼”ç¤ºäº†è¿›ç¨‹æ± ä¸­çš„è¿›ç¨‹å¦‚ä½•é€šä¿¡ï¼š</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding:utf-8 -*-</span>

<span class="token comment"># ä¿®æ”¹importä¸­çš„Queueä¸ºManager</span>
<span class="token keyword">from</span> multiprocessing <span class="token keyword">import</span> Manager<span class="token punctuation">,</span>Pool
<span class="token keyword">import</span> os<span class="token punctuation">,</span>time<span class="token punctuation">,</span>random

<span class="token keyword">def</span> <span class="token function">reader</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"readerå¯åŠ¨(%s),çˆ¶è¿›ç¨‹ä¸º(%s)"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>os<span class="token punctuation">.</span>getpid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> os<span class="token punctuation">.</span>getppid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>q<span class="token punctuation">.</span>qsize<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"readerä»Queueè·å–åˆ°æ¶ˆæ¯ï¼š%s"</span> <span class="token operator">%</span> q<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">writer</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"writerå¯åŠ¨(%s),çˆ¶è¿›ç¨‹ä¸º(%s)"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>os<span class="token punctuation">.</span>getpid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> os<span class="token punctuation">.</span>getppid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token string">"itcast"</span><span class="token punctuation">:</span>
        q<span class="token punctuation">.</span>put<span class="token punctuation">(</span>i<span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__<span class="token operator">==</span><span class="token string">"__main__"</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"(%s) start"</span> <span class="token operator">%</span> os<span class="token punctuation">.</span>getpid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    q <span class="token operator">=</span> Manager<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Queue<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># ä½¿ç”¨Managerä¸­çš„Queue</span>
    po <span class="token operator">=</span> Pool<span class="token punctuation">(</span><span class="token punctuation">)</span>
    po<span class="token punctuation">.</span>apply_async<span class="token punctuation">(</span>writer<span class="token punctuation">,</span> <span class="token punctuation">(</span>q<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># å…ˆè®©ä¸Šé¢çš„ä»»åŠ¡å‘Queueå­˜å…¥æ•°æ®ï¼Œç„¶åå†è®©ä¸‹é¢çš„ä»»åŠ¡å¼€å§‹ä»ä¸­å–æ•°æ®</span>

    po<span class="token punctuation">.</span>apply_async<span class="token punctuation">(</span>reader<span class="token punctuation">,</span> <span class="token punctuation">(</span>q<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    po<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
    po<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"(%s) End"</span> <span class="token operator">%</span> os<span class="token punctuation">.</span>getpid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿è¡Œç»“æœ:</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">(</span><span class="token number">11095</span><span class="token punctuation">)</span> start
writerå¯åŠ¨<span class="token punctuation">(</span><span class="token number">11097</span><span class="token punctuation">)</span><span class="token punctuation">,</span>çˆ¶è¿›ç¨‹ä¸º<span class="token punctuation">(</span><span class="token number">11095</span><span class="token punctuation">)</span>
readerå¯åŠ¨<span class="token punctuation">(</span><span class="token number">11098</span><span class="token punctuation">)</span><span class="token punctuation">,</span>çˆ¶è¿›ç¨‹ä¸º<span class="token punctuation">(</span><span class="token number">11095</span><span class="token punctuation">)</span>
readerä»Queueè·å–åˆ°æ¶ˆæ¯ï¼ši
readerä»Queueè·å–åˆ°æ¶ˆæ¯ï¼št
readerä»Queueè·å–åˆ°æ¶ˆæ¯ï¼šc
readerä»Queueè·å–åˆ°æ¶ˆæ¯ï¼ša
readerä»Queueè·å–åˆ°æ¶ˆæ¯ï¼šs
readerä»Queueè·å–åˆ°æ¶ˆæ¯ï¼št
<span class="token punctuation">(</span><span class="token number">11095</span><span class="token punctuation">)</span> End<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h1 id="åº”ç”¨ï¼šæ–‡ä»¶å¤¹copyå™¨ï¼ˆå¤šè¿›ç¨‹ç‰ˆï¼‰"><a href="#åº”ç”¨ï¼šæ–‡ä»¶å¤¹copyå™¨ï¼ˆå¤šè¿›ç¨‹ç‰ˆï¼‰" class="headerlink" title="åº”ç”¨ï¼šæ–‡ä»¶å¤¹copyå™¨ï¼ˆå¤šè¿›ç¨‹ç‰ˆï¼‰"></a>åº”ç”¨ï¼šæ–‡ä»¶å¤¹copyå™¨ï¼ˆå¤šè¿›ç¨‹ç‰ˆï¼‰</h1><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> multiprocessing
<span class="token keyword">import</span> os
<span class="token keyword">import</span> time
<span class="token keyword">import</span> random


<span class="token keyword">def</span> <span class="token function">copy_file</span><span class="token punctuation">(</span>queue<span class="token punctuation">,</span> file_name<span class="token punctuation">,</span>source_folder_name<span class="token punctuation">,</span>  dest_folder_name<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""copyæ–‡ä»¶åˆ°æŒ‡å®šçš„è·¯å¾„"""</span>
    f_read <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>source_folder_name <span class="token operator">+</span> <span class="token string">"/"</span> <span class="token operator">+</span> file_name<span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span>
    f_write <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>dest_folder_name <span class="token operator">+</span> <span class="token string">"/"</span> <span class="token operator">+</span> file_name<span class="token punctuation">,</span> <span class="token string">"wb"</span><span class="token punctuation">)</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        content <span class="token operator">=</span> f_read<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> content<span class="token punctuation">:</span>
            f_write<span class="token punctuation">.</span>write<span class="token punctuation">(</span>content<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">break</span>
    f_read<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
    f_write<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># å‘é€å·²ç»æ‹·è´å®Œæ¯•çš„æ–‡ä»¶åå­—</span>
    queue<span class="token punctuation">.</span>put<span class="token punctuation">(</span>file_name<span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># è·å–è¦å¤åˆ¶çš„æ–‡ä»¶å¤¹</span>
    source_folder_name <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"è¯·è¾“å…¥è¦å¤åˆ¶æ–‡ä»¶å¤¹åå­—:"</span><span class="token punctuation">)</span>

    <span class="token comment"># æ•´ç†ç›®æ ‡æ–‡ä»¶å¤¹</span>
    dest_folder_name <span class="token operator">=</span> source_folder_name <span class="token operator">+</span> <span class="token string">"[å‰¯æœ¬]"</span>

    <span class="token comment"># åˆ›å»ºç›®æ ‡æ–‡ä»¶å¤¹</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span>dest_folder_name<span class="token punctuation">)</span>
    <span class="token keyword">except</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>  <span class="token comment"># å¦‚æœæ–‡ä»¶å¤¹å·²ç»å­˜åœ¨ï¼Œé‚£ä¹ˆåˆ›å»ºä¼šå¤±è´¥</span>

    <span class="token comment"># è·å–è¿™ä¸ªæ–‡ä»¶å¤¹ä¸­æ‰€æœ‰çš„æ™®é€šæ–‡ä»¶å</span>
    file_names <span class="token operator">=</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>source_folder_name<span class="token punctuation">)</span>

    <span class="token comment"># åˆ›å»ºQueue</span>
    queue <span class="token operator">=</span> multiprocessing<span class="token punctuation">.</span>Manager<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Queue<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># åˆ›å»ºè¿›ç¨‹æ± </span>
    pool <span class="token operator">=</span> multiprocessing<span class="token punctuation">.</span>Pool<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>

    <span class="token keyword">for</span> file_name <span class="token keyword">in</span> file_names<span class="token punctuation">:</span>
        <span class="token comment"># å‘è¿›ç¨‹æ± ä¸­æ·»åŠ ä»»åŠ¡</span>
        pool<span class="token punctuation">.</span>apply_async<span class="token punctuation">(</span>copy_file<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span>queue<span class="token punctuation">,</span> file_name<span class="token punctuation">,</span> source_folder_name<span class="token punctuation">,</span> dest_folder_name<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment"># ä¸»è¿›ç¨‹æ˜¾ç¤ºè¿›åº¦</span>
    pool<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

    all_file_num <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>file_names<span class="token punctuation">)</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        file_name <span class="token operator">=</span> queue<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> file_name <span class="token keyword">in</span> file_names<span class="token punctuation">:</span>
            file_names<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>file_name<span class="token punctuation">)</span>

        copy_rate <span class="token operator">=</span> <span class="token punctuation">(</span>all_file_num<span class="token operator">-</span><span class="token builtin">len</span><span class="token punctuation">(</span>file_names<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span><span class="token operator">/</span>all_file_num
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\r%.2f...(%s)"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>copy_rate<span class="token punctuation">,</span> file_name<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" "</span><span class="token operator">*</span><span class="token number">50</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> copy_rate <span class="token operator">>=</span> <span class="token number">100</span><span class="token punctuation">:</span>
            <span class="token keyword">break</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>









</div></section><div id="reward-container"><span class="hty-icon-button button-glow" id="reward-button" title="Donate" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === &quot;none&quot;) ? &quot;block&quot; : &quot;none&quot;;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-hand-coin-line"></use></svg></span><div id="reward-comment">æˆ‘å¾ˆå¯çˆ±ï¼Œè¯·ç»™æˆ‘é’±</div><div id="qr" style="display:none;"><div style="display:inline-block"><a href="/images/alipay-qrcode.jpg"><img loading="lazy" src="/images/alipay-qrcode.jpg" alt="æ”¯ä»˜å®" title="æ”¯ä»˜å®"></a><div><span style="color:#00A3EE"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-alipay-line"></use></svg></span></div></div><div style="display:inline-block"><a href="/images/qqpay-qrcode.jpg"><img loading="lazy" src="/images/qqpay-qrcode.jpg" alt="QQ æ”¯ä»˜" title="QQ æ”¯ä»˜"></a><div><span style="color:#12B7F5"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-qq-line"></use></svg></span></div></div><div style="display:inline-block"><a href="/images/wechatpay-qrcode.jpg"><img loading="lazy" src="/images/wechatpay-qrcode.jpg" alt="å¾®ä¿¡æ”¯ä»˜" title="å¾®ä¿¡æ”¯ä»˜"></a><div><span style="color:#2DC100"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-wechat-pay-line"></use></svg></span></div></div></div></div><ul class="post-copyright"><li class="post-copyright-author"><strong>Post author: </strong>Explorer</li><li class="post-copyright-link"><strong>Post link: </strong><a href="http://ccsu.top/posts/b23c6bbe/" title="Pythonå¤šä»»åŠ¡-è¿›ç¨‹">http://ccsu.top/posts/b23c6bbe/</a></li><li class="post-copyright-license"><strong>Copyright Notice: </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><svg class="icon"><use xlink:href="#icon-creative-commons-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-by-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-nc-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-sa-line"></use></svg></a> unless otherwise stated.</li></ul></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/posts/108619c9/" rel="prev" title="æ ‘è“æ´¾å®ç°è¿œç¨‹ç›‘æ§"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-left-s-line"></use></svg><span class="post-nav-text">æ ‘è“æ´¾å®ç°è¿œç¨‹ç›‘æ§</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/posts/a4da6e72/" rel="next" title="Pythonå¤šä»»åŠ¡-çº¿ç¨‹"><span class="post-nav-text">Pythonå¤šä»»åŠ¡-çº¿ç¨‹</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-right-s-line"></use></svg></a></div></div></div><div class="hty-card" id="comment"><div id="waline"></div><script src="/js/comments/waline.js" type="module" defer></script></div></main><footer class="sidebar-translate" id="footer"><div class="beian"><a rel="noopener" href="https://beian.miit.gov.cn/" target="_blank">çš–ICPå¤‡20002891å·-2</a></div><div class="copyright"><span>&copy; 2016 â€“ 2022 </span><span class="with-love" id="animate" title="èµåŠ©è€…ä»¬"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-cloud-line"></use></svg></span><span class="author"> Explorer</span></div><div class="powered"><span>Powered by <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> v6.0.0</span><span class="footer-separator">|</span><span>Theme - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.8.8</span></div><div class="live-time"><span>æœ¬åšå®¢å·²èŒèŒå“’åœ°è¿è¡Œ</span><span id="display_live_time"></span><span class="moe-text">(â—'â—¡'â—)</span><script>function blog_live_time() {
  setTimeout(blog_live_time, 1000);
  const start = new Date('2022-02-12T00:00:00');
  const now = new Date();
  const timeDiff = (now.getTime() - start.getTime());
  const msPerMinute = 60 * 1000;
  const msPerHour = 60 * msPerMinute;
  const msPerDay = 24 * msPerHour;
  const passDay = Math.floor(timeDiff / msPerDay);
  const passHour = Math.floor((timeDiff % msPerDay) / 60 / 60 / 1000);
  const passMinute = Math.floor((timeDiff % msPerHour) / 60 / 1000);
  const passSecond = Math.floor((timeDiff % msPerMinute) / 1000);
  display_live_time.innerHTML = ` ${passDay} Days ${passHour} Hours ${passMinute} Minutes ${passSecond} Seconds`;
}
blog_live_time();
</script></div><div id="busuanzi"><span id="busuanzi_container_site_pv" title="Total Views"><span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-eye-line"></use></svg></span><span id="busuanzi_value_site_pv"></span></span><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></footer><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-up-s-line"></use></svg><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#6200ee" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="Search"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search-line"></use></svg></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script src="/js/search/local-search.js" defer type="module"></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-close-line"></use></svg></span></div><div class="search-input-container"><input class="search-input" id="local-search-input" type="text" placeholder="Searching..." value=""></div><div id="local-search-result"></div></div><script>function initMourn() {
  const date = new Date();
  const today = (date.getMonth() + 1) + "-" + date.getDate()
  const mourn_days = ["4-4","9-18"]
  if (mourn_days.includes(today)) {
    document.documentElement.style.filter = "grayscale(1)";
  }
}
initMourn();</script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right","width":150,"height":350,"hOffset":null,"vOffset":null},"mobile":{"show":true},"log":false});</script></body></html>